paths:
  /v1/marketdata/symbols:
    get:
      summary: List available symbols (market pairs)
      tags: [MarketData]
      security:
        - bearerAuth: []
      parameters:
        - name: page
          in: query
          schema:
            type: integer
            default: 1
        - name: per_page
          in: query
          schema:
            type: integer
            default: 50
        - name: active
          in: query
          schema:
            type: boolean
      responses:
        "200":
          description: Symbol list
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "../components/schemas.yaml#/components/schemas/SuccessEnvelope"
                  - type: object
                    properties:
                      data:
                        $ref: "../components/market_schemas.yaml#/components/schemas/SymbolList"
        "401":
          $ref: "../components/responses.yaml#/components/responses/Unauthorized"
        "500":
          $ref: "../components/responses.yaml#/components/responses/InternalServerError"

  /v1/marketdata/candles:
    get:
      summary: Get candles (OHLCV) for a symbol and interval (historical)
      tags: [MarketData]
      security:
        - bearerAuth: []
      parameters:
        - name: symbol
          in: query
          required: true
          schema:
            type: string
        - name: interval
          in: query
          required: true
          schema:
            type: string
            example: 1m
        - name: start
          in: query
          schema:
            type: string
            format: date-time
          description: "Start (inclusive) - ISO8601"
        - name: end
          in: query
          schema:
            type: string
            format: date-time
          description: "End (exclusive) - ISO8601"
        - name: limit
          in: query
          schema:
            type: integer
            default: 100
      responses:
        "200":
          description: Candle series
          headers:
            Cache-Control:
              description: "Cache policy for historical data (set by API)"
              schema:
                type: string
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "../components/schemas.yaml#/components/schemas/SuccessEnvelope"
                  - type: object
                    properties:
                      data:
                        $ref: "../components/market_schemas.yaml#/components/schemas/CandleSeries"
        "400":
          $ref: "../components/responses.yaml#/components/responses/BadRequest"
        "401":
          $ref: "../components/responses.yaml#/components/responses/Unauthorized"
        "404":
          $ref: "../components/market_responses.yaml#/components/responses/BadSymbol"
        "429":
          $ref: "../components/market_responses.yaml#/components/responses/RateLimited"
        "500":
          $ref: "../components/responses.yaml#/components/responses/InternalServerError"

  /v1/marketdata/ticks:
    get:
      summary: Get trades (ticks) for a symbol (historical)
      tags: [MarketData]
      security:
        - bearerAuth: []
      parameters:
        - name: symbol
          in: query
          required: true
          schema:
            type: string
        - name: start
          in: query
          schema:
            type: string
            format: date-time
        - name: end
          in: query
          schema:
            type: string
            format: date-time
        - name: limit
          in: query
          schema:
            type: integer
            default: 500
      responses:
        "200":
          description: Trade list
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "../components/schemas.yaml#/components/schemas/SuccessEnvelope"
                  - type: object
                    properties:
                      data:
                        $ref: "../components/market_schemas.yaml#/components/schemas/TickList"
        "400":
          $ref: "../components/responses.yaml#/components/responses/BadRequest"
        "401":
          $ref: "../components/responses.yaml#/components/responses/Unauthorized"
        "404":
          $ref: "../components/market_responses.yaml#/components/responses/BadSymbol"
        "429":
          $ref: "../components/market_responses.yaml#/components/responses/RateLimited"
        "500":
          $ref: "../components/responses.yaml#/components/responses/InternalServerError"

  /v1/marketdata/orderbook/{symbol}:
    get:
      summary: Orderbook snapshot (top N) for a symbol
      tags: [MarketData]
      security:
        - bearerAuth: []
      parameters:
        - name: symbol
          in: path
          required: true
          schema:
            type: string
        - name: depth
          in: query
          schema:
            type: integer
            default: 20
      responses:
        "200":
          description: Orderbook snapshot
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "../components/schemas.yaml#/components/schemas/SuccessEnvelope"
                  - type: object
                    properties:
                      data:
                        $ref: "../components/market_schemas.yaml#/components/schemas/OrderbookSnapshot"
        "401":
          $ref: "../components/responses.yaml#/components/responses/Unauthorized"
        "404":
          $ref: "../components/market_responses.yaml#/components/responses/BadSymbol"
        "500":
          $ref: "../components/responses.yaml#/components/responses/InternalServerError"

  /v1/marketdata/orderbook/{symbol}/history:
    get:
      summary: Historical orderbook deltas / snapshots for reconciliation
      tags: [MarketData]
      security:
        - bearerAuth: []
      parameters:
        - name: symbol
          in: path
          required: true
          schema:
            type: string
        - name: start
          in: query
          schema:
            type: string
            format: date-time
        - name: end
          in: query
          schema:
            type: string
            format: date-time
        - name: limit
          in: query
          schema:
            type: integer
            default: 100
      responses:
        "200":
          description: Orderbook history
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "../components/schemas.yaml#/components/schemas/SuccessEnvelope"
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          snapshots:
                            type: array
                            items:
                              $ref: "../components/market_schemas.yaml#/components/schemas/OrderbookSnapshot"
                          updates:
                            type: array
                            items:
                              $ref: "../components/market_schemas.yaml#/components/schemas/OrderbookUpdate"
        "401":
          $ref: "../components/responses.yaml#/components/responses/Unauthorized"
        "404":
          $ref: "../components/market_responses.yaml#/components/responses/BadSymbol"
        "500":
          $ref: "../components/responses.yaml#/components/responses/InternalServerError"

  /v1/marketdata/stream:
    get:
      summary: Real-time streaming info (WebSocket)
      tags: [MarketData]
      description: >
        This endpoint is the real-time streaming by WebSocket protocol.
